<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>InnoSearch - ê¸°ìˆ  ìƒì„¸</title>
  <link rel="stylesheet" href="./css/styles.css" />
  <style>
    body{ background:linear-gradient(180deg, #0e1330 0%, #0b1020 100%); }
    .section{ padding: 32px 0; }
    .container{ width:min(1100px,92%); margin:0 auto; }
    .card{
      background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:20px;
      box-shadow: 0 6px 16px rgba(0,0,0,.06); color:#111827;
    }
    h1{ margin:0 0 8px; font-size:24px; color:#111827; }
    .meta{ color:#6b7280; margin-bottom:16px; }
    table{ width:100%; border-collapse:collapse; }
    th, td{ text-align:left; border-bottom:1px solid #f1f5f9; padding:10px 8px; color:#111827; }
    th{ width:280px; color:#374151; font-weight:700; background:#f9fafb; }

    /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¶”ê°€ (ê¸°ì¡´ styles.cssì— .btnì´ ìˆì§€ë§Œ, ì—¬ê¸°ì„œë„ ì •ì˜í•´ ë§Œì¼ì˜ ê²½ìš° ëŒ€ë¹„) */
    #paper-search-actions .btn {
        display: inline-block;
        padding: 8px 15px;
        margin: 5px 10px 5px 0;
        background-color: #2563eb;
        color: white;
        text-decoration: none;
        border-radius: 8px;
        font-weight: bold;
        transition: background-color 0.2s;
    }
    #paper-search-actions .btn:hover {
        background-color: #1d4ed8;
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container nav">
      <a class="brand" href="./home.html">
        <span class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M12 2l8.66 5v10L12 22l-8.66-5V7z" fill="currentColor" opacity=".12"/>
            <path d="M12 6l6.06 3.5v7L12 20l-6.06-3.5v-7z" fill="currentColor"/>
          </svg>
        </span>
        <span class="brand-text">InnoSearch</span>
      </a>
      <nav class="menu" aria-label="ì£¼ìš” ë©”ë‰´">
        <a href="./matching.html">ê¸°ìˆ /ë¶„ì•¼</a>
        <a href="./goodex.html">ìš°ìˆ˜ì‚¬ë¡€</a>
        <a href="./organ.html">ì°½ì—…ì‹œì„¤</a>
        <a href="./board.html">ê²Œì‹œíŒ</a>
      </nav>
      <div class="nav-actions">
        <a class="link" id="btn-login"  href="./login.html">ë¡œê·¸ì¸</a>
        <a class="btn primary" id="btn-signup" href="./signup.html">íšŒì›ê°€ì…</a>
        <a class="link" id="btn-mypage" href="./myLab.html" style="display:none;">ë§ˆì´í˜ì´ì§€</a>
        <a class="link" id="btn-logout" href="#" style="display:none;">ë¡œê·¸ì•„ì›ƒ</a>
        <span id="user-display" style="display:none; margin-right:10px; color:#cbd5e1;"></span>
      </div>
    </div>
  </header>

  <main class="section">
    <div class="container">
      <div class="card">
        <h1 id="techName">ê¸°ìˆ ëª…</h1>
        <div class="meta" id="techMeta">ë°ì´í„° ì†ŒìŠ¤: -</div>
        <div class="table-wrap">
          <table id="detailTable">
            <tbody></tbody>
          </table>
        </div>
        <div id="paper-search-actions" style="margin-top: 20px;">
        <h4>ê´€ë ¨ ë…¼ë¬¸ ê²€ìƒ‰ ğŸ”</h4>
        </div>
      </div>
      </div>
    </div>
  </main>

  <footer class="site-header"> <div class="container foot">
      <div class="brand lite">
        <span class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M12 2l8.66 5v10L12 22l-8.66-5V7z" fill="currentColor" opacity=".12" />
            <path d="M12 6l6.06 3.5v7L12 20l-6.06-3.5v-7z" fill="currentColor" />
          </svg>
        </span>
        <span class="brand-text">InnoSearch</span>
      </div>
      <div class="foot-right">
        <a href="#">ì´ìš©ì•½ê´€</a>
        <a href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
        <a href="#">ê³ ê°ì„¼í„°</a>
      </div>
    </div>
  </footer>

  <script src="./js/apiClient.js"></script>
  <script src="./js/session.js"></script>

  <script>
    const esc = s => String(s ?? '')
      .replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;')
      .replaceAll('"','&quot;').replaceAll("'",'&#39;');

    document.addEventListener('DOMContentLoaded', () => {
      const dataRaw = localStorage.getItem('selectedTechFull');
      if (!dataRaw) {
        document.getElementById('techName').textContent = 'ì„ íƒëœ ê¸°ìˆ ì´ ì—†ìŠµë‹ˆë‹¤.';
        document.getElementById('techMeta').textContent  = '';
        return;
      }

      const data = JSON.parse(dataRaw);
      const techName = data.name || 'ê¸°ìˆ  ìƒì„¸'; // ê¸°ìˆ ëª… ì¶”ì¶œ
      document.getElementById('techName').textContent = techName;
      document.getElementById('techMeta').textContent = `ë°ì´í„° ì†ŒìŠ¤: ${data.source || '-'}`;

      const tbody = document.querySelector('#detailTable tbody');
      tbody.innerHTML = '';
      const fields = data.fields || {};

      Object.entries(fields).forEach(([key, val]) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<th>${esc(key)}</th><td>${esc(val ?? '')}</td>`;
        tbody.appendChild(tr);
      });

      // ===== âœ… ë…¼ë¬¸ ê²€ìƒ‰ ë²„íŠ¼ ìƒì„± ì½”ë“œ ì‹œì‘ =====
      const paperSearchActions = document.getElementById('paper-search-actions');
      const encodedTechName = encodeURIComponent(techName);

      const searchEngines = {
        'Google Scholar': `https://scholar.google.com/scholar?q=${encodedTechName}`,
        'RISS': `http://www.riss.kr/search/Search.do?isDetailSearch=N&searchGubun=true&viewYn=OP&query=${encodedTechName}`,
        'DBpia': `https://www.dbpia.co.kr/search/topSearch?startCount=0&collection=ALL&searchField=ALL&sort=RANK&query=${encodedTechName}&prevQuery=${encodedTechName}`
      };

      for (const [engineName, url] of Object.entries(searchEngines)) {
        const button = document.createElement('a');
        button.href = url;
        button.textContent = `${engineName}ì—ì„œ ê²€ìƒ‰`;
        button.target = '_blank'; // ìƒˆ íƒ­ì—ì„œ ì—´ê¸°
        button.className = 'btn'; // ìŠ¤íƒ€ì¼ ì ìš©
        paperSearchActions.appendChild(button);
      }
      // ===== ë…¼ë¬¸ ê²€ìƒ‰ ë²„íŠ¼ ìƒì„± ì½”ë“œ ë =====
    });
  </script>
</body>
</html>